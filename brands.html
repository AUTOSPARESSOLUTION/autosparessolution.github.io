<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse by Brand - Auto Spares Solution</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0a7c71;
            --secondary: #e74c3c;
            --accent: #f1c40f;
            --dark: #0f2027;
            --light: #f8f9fa;
            --success: #27ae60;
            --warning: #f39c12;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        header {
            text-align: center;
            padding: 1.5rem 1rem;
            background: rgba(0, 0, 0, 0.85);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .logo {
            height: 60px;
            width: auto;
            border-radius: 5px;
        }
        
        header h1 {
            margin: 0;
            font-size: 2.2rem;
            letter-spacing: 1px;
            color: var(--accent);
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
        }
        
        .tagline {
            color: #a0d9d4;
            font-size: 1rem;
            margin-top: 0.5rem;
            max-width: 600px;
        }
        
        nav {
            background: rgba(0, 0, 0, 0.9);
            padding: 0.8rem 1rem;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            align-items: center;
            gap: 1.5rem;
            position: sticky;
            top: 80px;
            z-index: 99;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            position: relative;
            padding: 0.3rem 0;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        nav a:hover {
            color: var(--accent);
        }
        
        nav a i {
            font-size: 1.1rem;
        }
        
        #cart-count {
            background: var(--secondary);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            position: absolute;
            top: -8px;
            right: -12px;
        }
        
        .section {
            padding: 3rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin: 1.5rem 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--accent);
            position: relative;
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 80px;
            height: 3px;
            background: var(--primary);
            margin: 0.5rem auto 0;
            border-radius: 3px;
        }
        
        .brands-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 25px;
            margin-top: 20px;
        }
        
        .brand-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 20px;
            width: 160px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .brand-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            background: rgba(255, 255, 255, 0.12);
        }
        
        .brand-card.active {
            border-color: var(--primary);
            background: rgba(10, 124, 113, 0.2);
        }
        
        .brand-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin: 0 auto 15px;
            background: white;
            padding: 10px;
            border-radius: 10px;
        }
        
        .brand-name {
            font-weight: 600;
            color: var(--accent);
            font-size: 1.1rem;
        }
        
        .filter-info {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(10, 124, 113, 0.2);
            border-radius: 8px;
        }
        
        .filter-info h3 {
            color: var(--accent);
            margin-bottom: 5px;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .product-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .in-stock {
            background: var(--success);
        }
        
        .low-stock {
            background: var(--warning);
        }
        
        .out-of-stock {
            background: var(--secondary);
        }
        
        .product-image {
            width: 100%;
            height: 180px;
            object-fit: contain;
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
        }
        
        .product-name {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--accent);
            font-size: 1.2rem;
        }
        
        .product-desc {
            font-size: 0.9rem;
            margin-bottom: 15px;
            color: #ddd;
            min-height: 40px;
        }
        
        .product-price {
            font-size: 1.3rem;
            font-weight: 700;
            margin: 10px 0;
            color: var(--primary);
        }
        
        .product-specs {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 0.9rem;
            color: #aaa;
        }
        
        .product-action {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            gap: 8px;
            flex: 1;
            margin: 0 5px;
        }
        
        .btn:hover {
            background: #09645a;
            transform: translateY(-2px);
        }
        
        .btn-whatsapp {
            background: #25D366;
        }
        
        .btn-whatsapp:hover {
            background: #1ebd5b;
        }
        
        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .no-products {
            text-align: center;
            padding: 40px;
            grid-column: 1 / -1;
            color: #aaa;
        }
        
        .no-products i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            grid-column: 1 / -1;
            color: #aaa;
        }
        
        .loading i {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--accent);
        }
        
        .error-message {
            text-align: center;
            padding: 40px;
            grid-column: 1 / -1;
            color: var(--secondary);
        }
        
        .error-message i {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--success);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .toast.error {
            background: var(--secondary);
        }
        
        .search-container {
            padding: 1rem;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            margin: 1rem 0 2rem;
            position: relative;
        }
        
        #search-input {
            width: 100%;
            padding: 0.9rem 1rem 0.9rem 3rem;
            border-radius: 5px;
            border: none;
            font-size: 1rem;
            background: rgba(255,255,255,0.1);
            color: white;
            transition: all 0.3s;
        }
        
        #search-input:focus {
            outline: none;
            background: rgba(255,255,255,0.15);
            box-shadow: 0 0 0 2px var(--primary);
        }
        
        .search-icon {
            position: absolute;
            left: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
        }
        
        .stock-filter {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .stock-filter-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .stock-filter-btn.active {
            background: var(--primary);
            border-color: var(--primary);
        }
        
        footer {
            background: rgba(0, 0, 0, 0.9);
            color: #ccc;
            padding: 3rem 1rem 2rem;
            text-align: center;
            margin-top: 3rem;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            text-align: left;
        }
        
        .footer-column h3 {
            color: var(--accent);
            margin-bottom: 1.2rem;
            font-size: 1.2rem;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 0.6rem;
        }
        
        .footer-links a {
            color: #aaa;
            text-decoration: none;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #333;
            color: white;
            transition: all 0.3s;
        }
        
        .social-links a:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }
        
        .copyright {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid #333;
            font-size: 0.9rem;
            color: #777;
        }
        
        @media (max-width: 768px) {
            .brands-container {
                gap: 15px;
            }
            
            .brand-card {
                width: 140px;
                padding: 15px;
            }
            
            .brand-logo {
                width: 70px;
                height: 70px;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .brands-container {
                gap: 10px;
            }
            
            .brand-card {
                width: 120px;
                padding: 10px;
            }
            
            .brand-logo {
                width: 60px;
                height: 60px;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 1.8rem;
            }
            
            .product-action {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo-container">
            <img src="https://autosparessolution.github.io/images/ASS.jpg" alt="Auto Spares Solution Logo" class="logo">
            <div>
                <h1>Auto Spares Solution</h1>
                <p class="tagline">Browse products by brand</p>
            </div>
        </div>
    </header>
    
    <nav>
        <a href="index.html"><i class="fas fa-arrow-left"></i> Back to Main Site</a>
        <a href="#tvs"><i class="fas fa-tag"></i> TVS</a>
        <a href="#stl"><i class="fas fa-tag"></i> STL</a>
        <a href="#vrp"><i class="fas fa-tag"></i> VRP</a>
        <a href="#other"><i class="fas fa-tag"></i> Other Brands</a>
    </nav>

    <div class="container">
        <section class="section">
            <h2 class="section-title">Browse by Brand</h2>
            <p style="text-align: center; margin-bottom: 20px;">Select a brand to view their products</p>
            
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="search-input" placeholder="Search by part number or description...">
            </div>
            
            <div class="stock-filter">
                <div class="stock-filter-btn active" data-stock="all">All Products</div>
                <div class="stock-filter-btn" data-stock="in-stock">In Stock Only</div>
                <div class="stock-filter-btn" data-stock="out-of-stock">Out of Stock</div>
            </div>
            
            <div class="brands-container" id="brands-container">
                <div class="brand-card active" data-brand="all">
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiByeD0iMTAiIGZpbGw9IiMwYTdjNzEiLz4KPHRleHQgeD0iNDAiIHk9IjQ1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCI+QUxMPC90ZXh0Pgo8L3N2Zz4K" alt="All Brands" class="brand-logo">
                    <div class="brand-name">All Brands</div>
                </div>
                <!-- Brands will be loaded dynamically from CSV -->
            </div>
        </section>
        
        <section class="section">
            <div class="filter-info" id="filter-info">
                <h3>Showing Products: <span id="current-brand">All Brands</span></h3>
                <p id="product-count">Loading products...</p>
            </div>
            
            <div class="products-grid" id="products-container">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <h3>Loading Products</h3>
                    <p>Please wait while we load our product catalog</p>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h3>Auto Spares Solution</h3>
                <p>Your trusted partner for premium automobile spare parts since 2020.</p>
                <p><i class="fas fa-map-marker-alt"></i> Office: 101, 1st floor, 57/5, Q Road, Howrah, WB 711108</p>
                <p><i class="fas fa-warehouse"></i> Warehouse: 1 no British Indian Street, Kolkata, WB 700069</p>
            </div>
            
            <div class="footer-column">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="index.html"><i class="fas fa-chevron-right"></i> Home</a></li>
                    <li><a href="index.html#about"><i class="fas fa-chevron-right"></i> About Us</a></li>
                    <li><a href="index.html#products"><i class="fas fa-chevron-right"></i> Products</a></li>
                    <li><a href="index.html#investors"><i class="fas fa-chevron-right"></i> Investors</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>Policy</h3>
                <ul class="footer-links">
                    <li><a href="index.html#policies"><i class="fas fa-chevron-right"></i> Privacy Policy</a></li>
                    <li><a href="index.html#policies"><i class="fas fa-chevron-right"></i> Terms & Conditions</a></li>
                    <li><a href="index.html#policies"><i class="fas fa-chevron-right"></i> Return Policy</a></li>
                    <li><a href="index.html#policies"><i class="fas fa-chevron-right"></i> Shipping Policy</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>Contact Us</h3>
                <ul class="footer-links">
                    <li><a href="tel:03369028606"><i class="fas fa-phone"></i> 03369028606</a></li>
                    <li><a href="mailto:contact@autosparessolution.com"><i class="fas fa-envelope"></i> contact@autosparessolution.com</a></li>
                </ul>
                <div class="social-links">
                    <a href="#" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" title="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="https://wa.me/03369028606" title="WhatsApp" target="_blank"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            <p>&copy; 2025 Auto Spares Solution. All Rights Reserved. | GSTIN: 19ANOPD3300R1ZO</p>
        </div>
    </footer>

    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">Product added to cart!</span>
    </div>

    <script>
        // Global variables
        let productsData = [];
        let brandsData = [];
        let currentBrand = 'all';
        let currentStockFilter = 'all';
        let cart = [];
        let filteredProducts = [];
        
        // Updated references based on your information
        const imageBaseUrl = 'https://autosparessolution.github.io/images/';
        const csvFilePath = 'https://autosparessolution.github.io/prices.csv';
        const whatsappNumber = '03369028606';
        
        // DOM elements
        const brandsContainer = document.getElementById('brands-container');
        const productsContainer = document.getElementById('products-container');
        const currentBrandElement = document.getElementById('current-brand');
        const productCountElement = document.getElementById('product-count');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        const searchInput = document.getElementById('search-input');
        const stockFilterBtns = document.querySelectorAll('.stock-filter-btn');
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            
            // Add search functionality
            searchInput.addEventListener('input', function() {
                performSearch(this.value);
            });
            
            // Add stock filter functionality
            stockFilterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    stockFilterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentStockFilter = this.getAttribute('data-stock');
                    applyFilters();
                });
            });
        });
        
        // Perform search
        function performSearch(searchTerm) {
            const term = searchTerm.toLowerCase().trim();
            
            if (term === '') {
                applyFilters();
            } else {
                // When searching, show all matching products
                filteredProducts = productsData.filter(product => 
                    product.part.toLowerCase().includes(term) || 
                    (product.desc && product.desc.toLowerCase().includes(term))
                );
                
                displayProducts(filteredProducts);
            }
        }
        
        // Apply both brand and stock filters
        function applyFilters() {
            let tempProducts = productsData;
            
            // Apply brand filter
            if (currentBrand !== 'all') {
                tempProducts = tempProducts.filter(product => 
                    product.brand && product.brand.toLowerCase() === currentBrand
                );
            }
            
            // Apply stock filter
            if (currentStockFilter === 'in-stock') {
                tempProducts = tempProducts.filter(product => product.stock > 0);
            } else if (currentStockFilter === 'out-of-stock') {
                tempProducts = tempProducts.filter(product => product.stock <= 0);
            }
            
            filteredProducts = tempProducts;
            displayProducts(filteredProducts);
        }
        
        // Load product data from CSV
        function loadProducts() {
            // Show loading state
            productsContainer.innerHTML = `
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <h3>Loading Products</h3>
                    <p>Please wait while we load our product catalog</p>
                </div>
            `;
            
            // For demo purposes, we'll use sample data since the CSV might not be accessible
            // In production, you would fetch from the actual CSV URL
            const sampleData = `Material,Material,LIST PRICE,MRP PRICE,TYPE,FINISH,billing price,STOCK,Box Qty,Carton,brand
MA2710M02920000200,M18 X 2.5 X 100 KNURLED WH BOLT & NUT,132.05,165,AUTOMOVOTIVE PRICE LIST PARTS,200,83.19,2200,NaN,NaN,TVS
MA2710M02920000201,M18 X 2.5 X 110 KNURLED WH BOLT & NUT,142.05,175,AUTOMOVOTIVE PRICE LIST PARTS,200,93.19,1500,NaN,NaN,TVS
MA2710M02920000202,M18 X 2.5 X 120 KNURLED WH BOLT & NUT,152.05,185,AUTOMOVOTIVE PRICE LIST PARTS,200,103.19,0,NaN,NaN,TVS
STL001,STL Brake Pad Set,450.00,550,AUTOMOVOTIVE PRICE LIST PARTS,200,350.00,50,NaN,NaN,STL
STL002,STL Clutch Plate,1200.00,1400,AUTOMOVOTIVE PRICE LIST PARTS,200,950.00,25,NaN,NaN,STL
VRP001,VRP Fuel Pump,3200.00,3800,AUTOMOVOTIVE PRICE LIST PARTS,200,2800.00,10,NaN,NaN,VRP
VRP002,VRP Oil Filter,250.00,300,AUTOMOVOTIVE PRICE LIST PARTS,200,200.00,100,NaN,NaN,VRP
BOS001,BOSCH Spark Plug,180.00,220,AUTOMOVOTIVE PRICE LIST PARTS,200,150.00,200,NaN,NaN,BOSCH
MIN001,MINDA Horn Set,650.00,750,AUTOMOVOTIVE PRICE LIST PARTS,200,550.00,15,NaN,NaN,Minda`;
            
            try {
                console.log("Using sample product data for demonstration");
                parseCSVData(sampleData);
            } catch (err) {
                console.error("Error parsing sample data:", err);
                showToast("Error loading product data.", true);
                
                productsContainer.innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Unable to Load Products</h3>
                        <p>Error: ${err.message}</p>
                        <button class="btn" onclick="location.reload()" style="margin-top: 20px;">
                            <i class="fas fa-redo"></i> Try Again
                        </button>
                    </div>
                `;
            }
            
            // Uncomment this section and remove the sample data section above when your CSV is ready
            /*
            fetch(csvFilePath)
                .then(res => {
                    if (!res.ok) throw new Error("Failed to fetch CSV file. Status: " + res.status);
                    return res.text();
                })
                .then(csv => {
                    parseCSVData(csv);
                })
                .catch(err => {
                    console.error("Error loading CSV:", err);
                    showToast("Error loading product data. Please check if the CSV file exists and is accessible.", true);
                    
                    productsContainer.innerHTML = `
                        <div class="error-message">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h3>Unable to Load Products</h3>
                            <p>Error: ${err.message}</p>
                            <p>CSV URL: ${csvFilePath}</p>
                            <p>Please ensure the CSV file is available at the above URL.</p>
                            <button class="btn" onclick="location.reload()" style="margin-top: 20px;">
                                <i class="fas fa-redo"></i> Try Again
                            </button>
                        </div>
                    `;
                });
            */
        }
        
        // Parse CSV data
        function parseCSVData(csv) {
            console.log("Raw CSV content:", csv.substring(0, 500));
            
            const rows = csv.split("\n").filter(row => row.trim() !== "");
            
            if (rows.length === 0) {
                throw new Error("CSV data is empty");
            }
            
            const header = rows[0].split(",").map(h => h.trim().toLowerCase());
            
            console.log("CSV Header:", header);
            
            // Updated column indices to match your actual CSV structure
            const materialIndex = 0; // First Material column (part number)
            const descIndex = 1;     // Second Material column (description)
            const listIndex = 2;     // LIST PRICE
            const mrpIndex = 3;      // MRP PRICE
            const priceIndex = 6;    // billing price (7th column, index 6)
            const stockIndex = 7;    // STOCK (8th column, index 7)
            const brandIndex = 10;   // brand (11th column, index 10)
            
            console.log("Column indices:", {materialIndex, descIndex, listIndex, mrpIndex, priceIndex, stockIndex, brandIndex});
            
            // Process data rows
            productsData = rows.slice(1)
                .map(r => {
                    // Handle CSV with potential quotes and commas in values
                    const cols = r.split(',').map(c => c.trim().replace(/^"(.*)"$/, '$1'));
                    
                    // Skip empty rows or rows without material
                    if (cols.length < 2 || !cols[materialIndex] || cols[materialIndex] === '') return null;
                    
                    return {
                        part: cols[materialIndex]?.trim(),
                        desc: cols[descIndex]?.trim() || "Auto Spare Part",
                        List: parseFloat(cols[listIndex] || 0),
                        Mrp: parseFloat(cols[mrpIndex] || 0),     
                        price: parseFloat(cols[priceIndex] || 0),
                        stock: parseInt(cols[stockIndex] || 0),
                        brand: cols[brandIndex]?.trim() || "Other"
                    };
                })
                .filter(p => p !== null && p.part && p.part.trim() !== "");

            console.log('Loaded products:', productsData.length);
            console.log('Sample products:', productsData.slice(0, 5));
            
            if (productsData.length === 0) {
                throw new Error("No products found in CSV data after parsing.");
            }
            
            // Extract unique brands from products
            extractBrandsFromProducts();
            
            // Display brands
            displayBrands();
            
            // Display all products initially
            filteredProducts = productsData;
            displayProducts(filteredProducts);
        }
        
        // Extract unique brands from products
        function extractBrandsFromProducts() {
            const brandSet = new Set();
            
            productsData.forEach(product => {
                if (product.brand && product.brand.trim() !== "") {
                    brandSet.add(product.brand.trim());
                }
            });
            
            brandsData = Array.from(brandSet).sort();
            console.log('Extracted brands:', brandsData);
        }
        
        // Display brands in the brands container
        function displayBrands() {
            // Clear existing brands (except "All Brands")
            const allBrandsCard = brandsContainer.querySelector('[data-brand="all"]');
            brandsContainer.innerHTML = '';
            brandsContainer.appendChild(allBrandsCard);
            
            // Add brand cards for each brand
            brandsData.forEach(brand => {
                const brandCard = document.createElement('div');
                brandCard.className = 'brand-card';
                brandCard.setAttribute('data-brand', brand.toLowerCase());
                
                // Create optimized SVG logos instead of external images
                let logoBgColor = '#0a7c71';
                let logoText = brand.substring(0, 3).toUpperCase();
                
                // Set specific colors for known brands
                const brandColors = {
                    'tvs': '#0a7c71',
                    'stl': '#e74c3c',
                    'vrp': '#27ae60',
                    'bosch': '#34495e',
                    'minda': '#9b59b6',
                    'asco': '#e67e22',
                    'lucas': '#16a085',
                    'other': '#7f8c8d'
                };
                
                if (brandColors[brand.toLowerCase()]) {
                    logoBgColor = brandColors[brand.toLowerCase()];
                }
                
                // Create SVG logo as data URI for fast loading
                const svgLogo = `<svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="80" height="80" rx="10" fill="${logoBgColor}"/>
                    <text x="40" y="45" text-anchor="middle" fill="white" font-family="Arial" font-size="14" font-weight="bold">${logoText}</text>
                </svg>`;
                
                const svgDataUri = `data:image/svg+xml;base64,${btoa(svgLogo)}`;
                
                brandCard.innerHTML = `
                    <img src="${svgDataUri}" alt="${brand}" class="brand-logo">
                    <div class="brand-name">${brand}</div>
                `;
                
                brandsContainer.appendChild(brandCard);
            });
            
            // Add event listeners to brand cards
            const brandCards = brandsContainer.querySelectorAll('.brand-card');
            brandCards.forEach(card => {
                card.addEventListener('click', function() {
                    const brand = this.getAttribute('data-brand');
                    
                    // Update active state
                    brandCards.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Filter products
                    filterProductsByBrand(brand);
                });
            });
        }
        
        // Filter products by brand
        function filterProductsByBrand(brand) {
            currentBrand = brand;
            searchInput.value = ''; // Clear search when filtering by brand
            applyFilters();
            
            if (brand === 'all') {
                currentBrandElement.textContent = 'All Brands';
            } else {
                const brandName = brandsContainer.querySelector(`[data-brand="${brand}"] .brand-name`).textContent;
                currentBrandElement.textContent = brandName;
            }
        }
        
        // Display products in the grid
        function displayProducts(productsArray) {
            productsContainer.innerHTML = '';
            
            if (productsArray.length === 0) {
                productsContainer.innerHTML = `
                    <div class="no-products">
                        <i class="fas fa-box-open"></i>
                        <h3>No products found</h3>
                        <p>Try selecting a different brand or search term</p>
                    </div>
                `;
                productCountElement.textContent = '0 products found';
                return;
            }
            
            productCountElement.textContent = `${productsArray.length} products found`;
            
            productsArray.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                // Determine stock status
                let stockStatus = '';
                let stockClass = '';
                if (product.stock > 10) {
                    stockStatus = 'In Stock';
                    stockClass = 'in-stock';
                } else if (product.stock > 0) {
                    stockStatus = 'Low Stock';
                    stockClass = 'low-stock';
                } else {
                    stockStatus = 'Out of Stock';
                    stockClass = 'out-of-stock';
                }
                
                // Create image URL for the product (using part number as image name)
                const imageUrl = `${imageBaseUrl}${product.part}.png`;
                
                productCard.innerHTML = `
                    <div class="product-badge ${stockClass}">${stockStatus}</div>
                    <img src="${imageUrl}" 
                         alt="${product.part}" 
                         class="product-image"
                         onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDI1MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyNTAiIGhlaWdodD0iMTgwIiByeD0iOCIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwwLjEpIi8+CjxyZWN0IHg9IjMwIiB5PSIzMCIgd2lkdGg9IjE5MCIgaGVpZ2h0PSIxMjAiIHJ4PSI1IiBmaWxsPSIjMmM1MzY0Ii8+Cjx0ZXh0IHg9IjEyNSIgeT0iMTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZjFjNDBmIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIj4ke3Byb2R1Y3QucGFydH08L3RleHQ+Cjx0ZXh0IHg9IjEyNSIgeT0iMTIwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZmZmZmZmIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTAiPkF1dG8gUGFydDwvdGV4dD4KPC9zdmc+Cg=='">
                    <h3 class="product-name">${product.part}</h3>
                    <p class="product-desc">${product.desc}</p>
                    <div class="product-specs">
                        <span><i class="fas fa-tag"></i> ${product.brand || 'Unknown Brand'}</span>
                        <span><i class="fas fa-cubes"></i> Stock: ${product.stock || '0'}</span>
                    </div>
                    <div class="product-price">â‚¹${product.price || '0'}</div>
                    <div class="product-action">
                        <button class="btn" onclick="addToCart('${product.part}')" ${product.stock <= 0 ? 'disabled' : ''}>
                            <i class="fas fa-cart-plus"></i> ${product.stock <= 0 ? 'Out of Stock' : 'Add to Cart'}
                        </button>
                        <button class="btn btn-whatsapp" onclick="enquireOnWhatsApp('${product.part}', '${product.desc}')">
                            <i class="fab fa-whatsapp"></i> ${product.stock <= 0 ? 'Notify Me' : 'Enquire'}
                        </button>
                    </div>
                `;
                
                productsContainer.appendChild(productCard);
            });
        }
        
        // Add to cart function
        function addToCart(part) {
            const product = productsData.find(p => p.part === part);
            if (!product) return;
            
            // Check if product is already in cart
            const existingItem = cart.find(item => item.part === part);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    part: product.part,
                    desc: product.desc,
                    price: product.price,
                    quantity: 1
                });
            }
            
            // Update cart count in navigation
            const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
            const cartLink = document.querySelector('nav a[href="#cart"]');
            if (cartLink) {
                let countElement = cartLink.querySelector('#cart-count');
                if (!countElement) {
                    countElement = document.createElement('span');
                    countElement.id = 'cart-count';
                    cartLink.appendChild(countElement);
                }
                countElement.textContent = cartCount;
            }
            
            showToast(`${product.part} added to cart!`);
        }
        
        // Enquire on WhatsApp function
        function enquireOnWhatsApp(part, desc) {
            const product = productsData.find(p => p.part === part);
            const stockStatus = product.stock > 0 ? 'In Stock' : 'Out of Stock';
            const message = `I want to enquire about ${part} (${desc}). Current stock: ${stockStatus}`;
            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/${whatsappNumber}?text=${encodedMessage}`, '_blank');
        }
        
        // Show toast message
        function showToast(message, isError = false) {
            toastMessage.textContent = message;
            toast.classList.remove("error");
            if (isError) toast.classList.add("error");
            toast.classList.add("show");
            
            setTimeout(() => {
                toast.classList.remove("show");
            }, 3000);
        }
    </script>
</body>
    </html>
